#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',se=F,size=2, span = 1)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='gauss', nx=10,ny=10,sigma=.65)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',se=F,size=2, span = 1)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='gauss', nx=10,ny=10,sigma=.4)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',se=F,size=2, span = 1)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='gauss', nx=10,ny=10,sigma=.5)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',se=F,size=2, span = 1)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
?kernel2dsmooth
rm(list=ls())
# Preliminaries -----------------------------------------------------------
require(ggplot2)
require(dplyr)
require(lme4)
require(lmerTest)
require(lattice)
require(psych)
require(BayesFactor)
require(smoothie)
se <- function(x) {sd(x) / sqrt(length(x))};
dodge <- position_dodge(width=0.9)
# Import data -----------------------------------------------------------
# only works in Rstudio -- otherwise you have to set the path manually!
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
data = read.csv('data_dis.csv') %>% arrange(subject) %>% filter(rating > -1) %>% mutate(rating = rating / 8)
# how many subjects are there?
numsubj = length(unique(data$subject))
numobs = nrow(data)
df.graph = data %>% group_by(green_prob, blue_prob) %>% summarise(rating.mean = mean(rating), rating.se = se(rating))
wireframe(rating.mean ~ blue_prob * green_prob, data = df.graph, colorkey = F, drape = TRUE,  screen=list(z=120, x=-70, y=0),
xlab = list(""), ylab = list(""), zlab = list(""), par.settings = list(axis.line = list(col = NA)),
scales = list(col = 1, relation = 'free', lwd = 3), zlim = c(.2, .8))
df.graph.2d = data %>%
group_by(green_prob, blue_prob) %>%
summarise(rating.mean = mean(rating),
rating.se = se(rating)) %>%
ungroup() %>%
mutate_at(vars(green_prob,blue_prob),funs(factor(.,labels = paste0(seq(10,100,10),"%"))))
data.smooth = matrix(nrow=10,ncol=10)
probs = levels(df.graph.2d$green_prob)
for (i in 1:10) {
for (j in 1:10) {
data.smooth[i,j] = (df.graph.2d %>% filter(green_prob == probs[i], blue_prob == probs[j]))$rating.mean
}
}
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='gauss', nx=10,ny=10,sigma=.5)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',span=1,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='boxcar', n=1)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',span=1,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='boxcar', n=3)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',span=1,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='boxcar', n=2)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',span=1,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='boxcar', n=2)
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='boxcar', n=1.5)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',span=1,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='gauss', nx=2,ny=2,sigma=1)
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='laplacian')
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',span=1,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='laplacian', alpha = .5)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',span=1,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='gauss', nx=10,ny=10,sigma=.5)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',span=1,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='gauss', nx=10,ny=10,sigma=.7)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',span=1,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='gauss', nx=10,ny=10,sigma=.55)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',span=1,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
data.smoothed = kernel2dsmooth(data.smooth, kernel.type='gauss', nx=10,ny=10,sigma=.4)
for (i in 1:10) {
for (j in 1:10) {
df.graph.2d$rating.smooth[df.graph.2d$green_prob == probs[i] & df.graph.2d$blue_prob == probs[j]] = data.smoothed[i,j]
}
}
ggplot(df.graph.2d,aes(x = green_prob, y = rating.smooth, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
geom_line(size=3)+
geom_point(size=4)+
#geom_smooth(method='loess',span=1,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
ggplot(df.graph.2d,aes(x = green_prob, y = rating.mean, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
#geom_line(size=3)+
#geom_point(size=4)+
geom_smooth(method='loess',span=1,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
ggplot(df.graph.2d,aes(x = green_prob, y = rating.mean, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
#geom_line(size=3)+
#geom_point(size=4)+
geom_smooth(method='loess',span=.75,se=F,size=2)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
#ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
rm(list=ls())
# Preliminaries -----------------------------------------------------------
require(ggplot2)
require(dplyr)
require(lme4)
require(lmerTest)
require(lattice)
require(psych)
require(BayesFactor)
require(smoothie)
se <- function(x) {sd(x) / sqrt(length(x))};
dodge <- position_dodge(width=0.9)
# Import data -----------------------------------------------------------
# only works in Rstudio -- otherwise you have to set the path manually!
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
data = read.csv('data_con.csv') %>% arrange(subject) %>% filter(rating > -1) %>% mutate(rating = rating / 8)
# how many subjects are there?
numsubj = length(unique(data$subject))
numobs = nrow(data)
df.graph = data %>% group_by(green_prob, blue_prob) %>% summarise(rating.mean = mean(rating), rating.se = se(rating))
wireframe(rating.mean ~ blue_prob * green_prob, data = df.graph, colorkey = F, drape = TRUE,  screen=list(z=120, x=-70, y=0),
xlab = list(""), ylab = list(""), zlab = list(""), par.settings = list(axis.line = list(col = NA)),
scales = list(col = 1, relation = 'free', lwd = 3), zlim = c(.2, .8))
df.graph.2d = data %>%
group_by(green_prob, blue_prob) %>%
summarise(rating.mean = mean(rating),
rating.se = se(rating)) %>%
ungroup() %>%
mutate_at(vars(green_prob,blue_prob),funs(factor(.,labels = paste0(seq(10,100,10),"%"))))
ggplot(df.graph.2d,aes(x = green_prob, y = rating.mean, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
#geom_line(size=3)+
#geom_point(size=4)+
geom_smooth(method='loess',se=F,size=2, span = 1)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
ggplot(df.graph.2d,aes(x = green_prob, y = rating.mean, group = blue_prob, color = blue_prob))+
#geom_errorbar(aes(ymin = rating.mean-rating.se,ymax = rating.mean+rating.se),width=0,size=0.5)+
#geom_line(size=3)+
#geom_point(size=4)+
geom_smooth(method='loess',se=F,size=2, span = .75)+
labs(x = '',
color = '',
y = '')+
scale_color_grey(start = 0.85, end = 0)+
theme_bw()+
theme(text = element_text(size = 26,color='black'),
panel.grid = element_blank(),
legend.position = 'none',
legend.direction = 'horizontal'
)+
#guides(col = guide_legend(nrow = 2, direction = 'vertical', byrow=T)) +
ylim(0, .8)+
scale_y_continuous(breaks = c()) +
scale_x_discrete(breaks = c())
